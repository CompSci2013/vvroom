# 303: Request Coordinator Service

**Status:** Complete
**Depends On:** 302-api-service
**Blocks:** 306-resource-management-service

---

## Learning Objectives

After completing this section, you will:
- Understand the three-layer request processing model (cache, dedup, HTTP)
- Know how to implement TTL-based response caching
- Recognize the in-flight deduplication pattern for preventing duplicate requests
- Be able to implement exponential backoff retry logic

---

## Objective

Create the `RequestCoordinatorService` that provides intelligent request coordination with three processing layers: response caching, in-flight deduplication, and HTTP execution with retry.

---

## Why

When users interact with the vvroom application, they generate many API requests:
- Changing filters → new data fetch
- Navigating between pages → data fetch
- Browser back/forward → URL change → data fetch
- Pop-out windows → parallel data fetch

Without coordination, these requests can:
1. **Overwhelm the API** — Same request sent multiple times
2. **Waste bandwidth** — Re-fetching data that hasn't changed
3. **Create race conditions** — Responses arriving out of order
4. **Fail silently** — Transient network errors losing data

`RequestCoordinatorService` solves these problems with a three-layer approach:

### Layer 1: Response Cache (TTL-Based)

```
Request comes in → Check cache → If fresh, return cached → Skip HTTP
```

- Stores successful responses with timestamp
- Returns cached response if within TTL
- Reduces API load for repeated queries

### Layer 2: In-Flight Deduplication

```
Request comes in → Check if same request in progress → If yes, share observable → One HTTP call serves many subscribers
```

- Tracks ongoing requests by key
- Multiple calls to same endpoint share one observable
- Prevents duplicate concurrent requests

### Layer 3: HTTP Request with Retry

```
Execute HTTP → On failure, wait → Retry with exponential backoff → After N failures, give up
```

- Executes the actual HTTP request
- Retries transient failures with exponential backoff
- Gives up after configurable number of attempts