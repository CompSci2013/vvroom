### 5. Verify Retry Behavior

To test retry, you can temporarily modify your API to return 503:

```typescript
// In browser DevTools Network tab:
// 1. Enable "Offline" mode briefly
// 2. Watch for retry attempts in console logs
// 3. See that after 2 retries, error is thrown
```

---

## Common Problems

| Symptom | Cause | Solution |
|---------|-------|----------|
| Interceptor not running | Not registered in providers | Add HTTP_INTERCEPTORS provider to app.module.ts |
| `multi: true` missing | Single interceptor overwrites others | Always use `multi: true` with HTTP_INTERCEPTORS |
| Infinite retry loop | All errors trigger retry | Only retry specific status codes (429, 5xx) |
| Error format wrong | Custom error handler | Ensure components expect the formatted error object |
| Retry too fast | No exponential backoff | Consider adding delay with `timer()` in retry |

---

## Key Takeaways

1. **Interceptors provide global error handling** — Every HTTP request flows through the interceptor
2. **Transient errors deserve retries** — 5xx and 429 errors often succeed on retry
3. **Consistent formatting simplifies handling** — Components receive the same error shape regardless of source

---

## Acceptance Criteria

- [ ] `src/app/framework/services/http-error.interceptor.ts` exists
- [ ] Interceptor implements `HttpInterceptor` interface
- [ ] `intercept()` method handles requests and errors
- [ ] Retry logic attempts 2 retries for 429, 500, 502, 503, 504
- [ ] Error formatting produces consistent object shape
- [ ] Error codes map correctly (400 → BAD_REQUEST, etc.)
- [ ] User-friendly messages for each status code
- [ ] Client-side errors (ErrorEvent) handled separately
- [ ] Error logging includes request URL and method
- [ ] Interceptor registered with `HTTP_INTERCEPTORS` provider
- [ ] TypeScript compilation succeeds
- [ ] JSDoc comments document all functions

---

## Next Step

Proceed to `314-global-error-handler.md` to create the global error handler for unhandled exceptions.