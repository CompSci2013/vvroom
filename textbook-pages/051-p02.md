---

## Sorting Convention

Sorting is controlled by these query parameters:

| Parameter | Type | Values | Description |
|-----------|------|--------|-------------|
| `sortBy` | string | field name | Field to sort by |
| `sortOrder` | string | `asc`, `desc` | Sort direction |

Example: `?sortBy=manufacturer&sortOrder=asc`

---

## Error Response Format

When an error occurs, the API returns:

```typescript
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",     // Error type identifier
    "message": "Invalid year range", // Human-readable message
    "details": {                     // Optional additional context
      "field": "yearMin",
      "reason": "must be less than yearMax"
    }
  }
}
```

### Common Error Codes

| Code | HTTP Status | Description |
|------|-------------|-------------|
| `VALIDATION_ERROR` | 400 | Invalid request parameters |
| `NOT_FOUND` | 404 | Resource not found |
| `INTERNAL_ERROR` | 500 | Server error |

---

## Highlight Parameters (h_* prefix)

The API supports "highlight" parameters for segmented statistics. These are query parameters with an `h_` prefix that tell the backend to compute statistics with a highlighted subset.

**Purpose:** Enable stacked bar charts showing "highlighted vs total" data.

**Example Request:**
```
GET /vehicles/details?manufacturer=Toyota&h_yearMin=2020&h_yearMax=2024
```

**Effect on Response:**
Statistics include `{total, highlighted}` objects instead of simple counts:

```json
{
  "statistics": {
    "byManufacturer": {
      "Toyota": { "total": 665, "highlighted": 234 },
      "Honda": { "total": 849, "highlighted": 0 }
    }
  }
}
```

Vehicles from Toyota are highlighted (234 of 665 match the year range 2020-2024), while Honda vehicles are not highlighted (0 of 849 match).

---

## Request/Response Flow