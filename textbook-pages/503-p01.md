# 503: API Adapter

**Status:** Complete
**Depends On:** 501-domain-adapter-pattern, 502-url-mapper-adapter, 302-api-service
**Blocks:** Phase 8 (Framework Components), Phase 9 (Feature Components)

---

## Learning Objectives

After completing this section, you will:
- Understand how to implement domain-specific API adapters
- Know how to transform API responses to domain models
- Recognize the difference between services and adapter classes
- Be able to implement cache key builders for request deduplication

---

## Objective

Create the `AutomobileApiAdapter` for fetching vehicle data and the `AutomobileCacheKeyBuilder` for generating unique cache keys. These adapters complete the domain adapter layer.

---

## Why

### API Adapter: Domain-Specific Fetching

The framework's `ResourceManagementService` knows *when* to fetch data (on filter changes), but not *how* to fetch automobile data. The API adapter provides:

1. **Endpoint knowledge** — Which URL to call (`/vehicles/details`)
2. **Parameter mapping** — How to convert filters to API params
3. **Response transformation** — How to convert API JSON to domain models

```typescript
// Framework calls:
apiAdapter.fetchData(filters, highlights)

// Adapter implements:
fetchData(filters) {
  const params = this.filtersToApiParams(filters);
  return this.api.get('/vehicles/details', params).pipe(
    map(response => ({
      results: response.results.map(r => VehicleResult.fromApiResponse(r)),
      total: response.total,
      statistics: VehicleStatistics.fromApiResponse(response.statistics)
    }))
  );
}
```

### Not an Angular Service

The API adapter is a **plain class**, not an `@Injectable()` service. This is intentional:

| Aspect | Service | Adapter Class |
|--------|---------|---------------|
| Lifecycle | Singleton | Created per config |
| Constructor | DI by Angular | Manual with args |
| Testability | Needs TestBed | Plain new() |
| Configuration | Environment-based | Constructor params |

The adapter is instantiated in the domain config factory with specific configuration (base URL, API service).