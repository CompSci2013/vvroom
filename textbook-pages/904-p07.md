---

## Key Takeaways

1. **Pop-outs are state receivers, not sources** — They display data but don't fetch it
2. **BroadcastChannel enables cross-window communication** — Built into modern browsers
3. **Injection tokens differentiate contexts** — `IS_POPOUT_TOKEN` tells components where they're running

---

## Acceptance Criteria

- [ ] `PopoutComponent` is created with `IS_POPOUT_TOKEN` provider
- [ ] Component extracts `gridId` and `componentId` from route params
- [ ] Domain is set via `DomainConfigRegistry.setActive()`
- [ ] BroadcastChannel communication initialized via `PopOutContextService`
- [ ] State updates from main window sync to `ResourceManagementService`
- [ ] Child routes defined for all pop-out-able component types
- [ ] `ng build` completes without errors

---

## Architecture Note: Cross-Window Communication

The pop-out system uses the browser's `BroadcastChannel` API for communication:

```
Main Window                    Pop-Out Window
    │                               │
    │  ┌─────────────────────────┐  │
    │  │   BroadcastChannel      │  │
    │  │   'vvroom-popout'        │  │
    │  └─────────────────────────┘  │
    │                               │
    ├──── STATE_UPDATE ────────────→│
    │                               │
    │←───── PANEL_READY ───────────┤
    │                               │
    │←── URL_PARAMS_CHANGED ───────┤
    │                               │
```

**Message types:**

| Type | Direction | Purpose |
|------|-----------|---------|
| `STATE_UPDATE` | Main → Pop-out | Send current state (filters, results, statistics) |
| `PANEL_READY` | Pop-out → Main | Pop-out initialized, ready for state |
| `URL_PARAMS_CHANGED` | Pop-out → Main | User changed filter in pop-out |
| `CLOSE_POPOUT` | Main → Pop-out | Request pop-out to close |

This architecture ensures the main window remains the source of truth while pop-outs provide additional viewport space.

---

## Next Step

Proceed to `905-app-routing-module.md` to configure the application's routing, connecting all feature components into a navigable application.