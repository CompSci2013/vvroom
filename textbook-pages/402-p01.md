# 402: Domain Data Models

**Status:** Complete
**Depends On:** 401-base-model-interface
**Blocks:** 403-domain-filter-statistics-models, Phase 5 (Domain Adapters)

---

## Learning Objectives

After completing this section, you will:
- Understand how to model domain entities as TypeScript classes
- Know how to handle API response transformation for different naming conventions
- Recognize the relationship between aggregate data (VehicleResult) and detail data (VinInstance)
- Be able to implement utility methods that encapsulate business logic

---

## Objective

Create the core data models for the automobile domain: `VehicleResult` for vehicle configurations and `VinInstance` for individual VIN records.

---

## Why

The automobile domain centers on two core entities:

### VehicleResult — The Aggregate

A `VehicleResult` represents a **unique vehicle configuration** — a specific combination of:
- Manufacturer (Toyota, Honda, Ford)
- Model (Camry, Accord, F-150)
- Year (2024, 2023, 2022)
- Body Class (Sedan, SUV, Truck)

Each configuration has an `instance_count` showing how many individual vehicles (VINs) exist for that configuration.

```
Toyota Camry 2024 Sedan — 156 instances
Honda Accord 2023 Sedan — 89 instances
Ford F-150 2024 Truck — 234 instances
```

### VinInstance — The Detail

A `VinInstance` represents a **single vehicle** with a unique VIN (Vehicle Identification Number). When users expand a row in the data table, they see individual VINs for that vehicle configuration.

```
1HGCM82633A123456 — Toyota Camry 2024
1HGCM82633A123457 — Toyota Camry 2024
1HGCM82633A123458 — Toyota Camry 2024
```

### The Relationship

```
VehicleResult (1) ———— (many) VinInstance
     ↓
manufacturer: Toyota
model: Camry
year: 2024
body_class: Sedan
instance_count: 156
     ↓
     Links to 156 VinInstance records
```

### API Response Handling

The API may return data in different formats:

```json
// snake_case from backend
{
  "vehicle_id": "TOY-CAM-2024-SED",
  "body_class": "Sedan",
  "instance_count": 156,
  "first_seen": "2024-01-15T10:30:00Z"
}

// camelCase from some endpoints
{
  "vehicleId": "TOY-CAM-2024-SED",
  "bodyClass": "Sedan",
  "instanceCount": 156,
  "firstSeen": "2024-01-15T10:30:00Z"
}
```

The `fromApiResponse()` method handles both:

```typescript
static fromApiResponse(data: any): VehicleResult {
  return new VehicleResult({
    vehicle_id: data.vehicle_id || data.vehicleId || data.id,
    body_class: data.body_class || data.bodyClass,
    instance_count: Number(data.instance_count || data.instanceCount || 0),
    first_seen: data.first_seen || data.firstSeen
  });
}
```