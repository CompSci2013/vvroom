```typescript
// src/app/framework/models/error-notification.interface.ts
// VERSION 1 (Section 209) - Error notification interfaces

/**
 * Error Notification Interfaces
 *
 * Provides comprehensive error categorization and notification configuration
 * for user-facing error messages using PrimeNG Toast.
 */

/**
 * Error category enumeration
 *
 * Categorizes errors by their source and nature for appropriate handling
 * and user messaging.
 */
export enum ErrorCategory {
  /**
   * Network-related errors (connection issues, timeouts, etc.)
   * HTTP status 0 or network failures
   */
  NETWORK = 'NETWORK',

  /**
   * Validation errors (invalid input, business rule violations)
   * HTTP status 400, 422
   */
  VALIDATION = 'VALIDATION',

  /**
   * Authorization/authentication errors
   * HTTP status 401 (unauthorized), 403 (forbidden)
   */
  AUTHORIZATION = 'AUTHORIZATION',

  /**
   * Server-side errors
   * HTTP status 5xx
   */
  SERVER = 'SERVER',

  /**
   * Client-side errors (JavaScript errors, component errors)
   * Runtime errors in the application
   */
  CLIENT = 'CLIENT',

  /**
   * Application-level errors (business logic, state errors)
   * Custom application errors
   */
  APPLICATION = 'APPLICATION',

  /**
   * Unknown or uncategorized errors
   * Fallback for unrecognized error types
   */
  UNKNOWN = 'UNKNOWN'
}

/**
 * Error severity levels
 *
 * Maps to PrimeNG Toast severity levels for visual feedback.
 * - 'success': Green (not typically used for errors)
 * - 'info': Blue (informational messages)
 * - 'warn': Yellow/Orange (warnings, validation errors)
 * - 'error': Red (critical errors)
 */
export type ErrorSeverity = 'success' | 'info' | 'warn' | 'error';

/**
 * Error notification data structure
 *
 * Contains all information needed to display an error to the user.
 *
 * @example
 * ```typescript
 * const notification: ErrorNotification = {
 *   category: ErrorCategory.NETWORK,
 *   severity: 'error',
 *   summary: 'Connection Error',
 *   detail: 'Unable to reach the server. Please check your network connection.',
 *   timestamp: new Date().toISOString(),
 *   status: 0
 * };
 * ```
 */
export interface ErrorNotification {
  /**
   * Error category for categorization and routing
   */
  category: ErrorCategory;

  /**
   * Display severity (maps to PrimeNG Toast severity)
   */
  severity: ErrorSeverity;

  /**
   * Brief error summary (shown as toast title)
   * Should be short and actionable
   */
  summary: string;

  /**
   * Detailed error message (shown as toast body)
   * Provides more context about the error
   */
  detail: string;

  /**
   * Optional error code for debugging
   * From API or generated locally
   */
  code?: string;

  /**
   * Timestamp of when error occurred
   * ISO 8601 format
   */
  timestamp?: string;

  /**
   * URL where error occurred (for HTTP errors)
   */
  url?: string;

  /**
   * HTTP status code (for network errors)
   */
  status?: number;

  /**
   * Original error object (for logging/debugging)
   * Not displayed to user, but useful for console/reporting
   */
  originalError?: any;
}

/**
 * Error display options
 *
 * Configuration for how errors should be displayed to users.
 * Passed to PrimeNG Toast component.
 */
export interface ErrorDisplayOptions {
  /**
   * Auto-hide duration in milliseconds
   * Set to 0 or null to prevent auto-hide
   * @default 5000 (5 seconds)
   */
  life?: number;

  /**
   * Whether to show close button
   * @default true
   */
  closable?: boolean;

  /**
   * Whether to show in sticky mode (no auto-hide)
   * @default false
   */
  sticky?: boolean;

  /**
   * Custom CSS class for the toast
   */
  styleClass?: string;

  /**
   * Toast position key (used with multiple toast containers)
   * @default 'app-toast'
   */
  key?: string;
}

/**
 * Default error display options
 */
export const DEFAULT_ERROR_DISPLAY_OPTIONS: ErrorDisplayOptions = {
  life: 5000,
  closable: true,
  sticky: false,
  key: 'app-toast'
};

/**
 * Error severity mapping configuration
 *
 * Maps error categories to default severity levels.
 * - NETWORK, SERVER, CLIENT, APPLICATION, UNKNOWN → 'error' (red)
 * - VALIDATION, AUTHORIZATION → 'warn' (yellow)
 */
export const ERROR_CATEGORY_SEVERITY_MAP: Record<ErrorCategory, ErrorSeverity> = {
  [ErrorCategory.NETWORK]: 'error',
  [ErrorCategory.VALIDATION]: 'warn',
  [ErrorCategory.AUTHORIZATION]: 'warn',
  [ErrorCategory.SERVER]: 'error',
  [ErrorCategory.CLIENT]: 'error',
  [ErrorCategory.APPLICATION]: 'error',
  [ErrorCategory.UNKNOWN]: 'error'
};

/**
 * Determine error category from HTTP status code
 *
 * @param status - HTTP status code
 * @returns Appropriate error category
 *
 * @example
 * ```typescript
 * getErrorCategoryFromStatus(401); // ErrorCategory.AUTHORIZATION
 * getErrorCategoryFromStatus(500); // ErrorCategory.SERVER
 * getErrorCategoryFromStatus(0);   // ErrorCategory.NETWORK
 * ```
 */
export function getErrorCategoryFromStatus(status: number): ErrorCategory {
  // Status 0 typically means network failure
  if (status === 0) {
    return ErrorCategory.NETWORK;
  }

  // Authentication/authorization errors
  if (status === 401 || status === 403) {
    return ErrorCategory.AUTHORIZATION;
  }

  // Validation errors
  if (status === 400 || status === 422) {
    return ErrorCategory.VALIDATION;
  }

  // Server errors
  if (status >= 500 && status < 600) {
    return ErrorCategory.SERVER;
  }

  // Other client errors
  if (status >= 400 && status < 500) {
    return ErrorCategory.CLIENT;
  }

  return ErrorCategory.UNKNOWN;
}

/**
 * Determine error category from error code string
 *
 * @param code - Error code string
 * @returns Appropriate error category
 *
 * @example
 * ```typescript
 * getErrorCategoryFromCode('NETWORK_TIMEOUT');    // ErrorCategory.NETWORK
 * getErrorCategoryFromCode('VALIDATION_FAILED'); // ErrorCategory.VALIDATION
 * getErrorCategoryFromCode('UNAUTHORIZED');      // ErrorCategory.AUTHORIZATION
 * ```
 */
export function getErrorCategoryFromCode(code: string): ErrorCategory {
  const upperCode = code.toUpperCase();

  if (upperCode.includes('NETWORK') || upperCode.includes('TIMEOUT')) {
    return ErrorCategory.NETWORK;
  }

  if (upperCode.includes('VALIDATION') || upperCode.includes('INVALID')) {
    return ErrorCategory.VALIDATION;
  }

  if (
    upperCode.includes('UNAUTHORIZED') ||
    upperCode.includes('FORBIDDEN') ||
    upperCode.includes('AUTH')
  ) {
    return ErrorCategory.AUTHORIZATION;
  }

  if (upperCode.includes('SERVER') || upperCode.includes('INTERNAL')) {
    return ErrorCategory.SERVER;
  }

  if (upperCode.includes('CLIENT')) {
    return ErrorCategory.CLIENT;
  }

  return ErrorCategory.UNKNOWN;
}

/**
 * Get user-friendly summary for error category
 *
 * @param category - Error category
 * @returns Summary text suitable for toast title
 */
export function getSummaryForCategory(category: ErrorCategory): string {
  switch (category) {
    case ErrorCategory.NETWORK:
      return 'Connection Error';
    case ErrorCategory.VALIDATION:
      return 'Validation Error';
    case ErrorCategory.AUTHORIZATION:
      return 'Access Denied';
    case ErrorCategory.SERVER:
      return 'Server Error';
    case ErrorCategory.CLIENT:
      return 'Application Error';
    case ErrorCategory.APPLICATION:
      return 'Operation Failed';
    case ErrorCategory.UNKNOWN:
    default:
      return 'Error';
  }
}

/**
 * Create error notification from HTTP error
 *
 * Converts an HTTP error response to an ErrorNotification.
 * Typically called from HTTP error interceptor.
 *
 * @param error - HTTP error object (from HttpErrorResponse or interceptor)
 * @returns ErrorNotification object ready for display
 *
 * @example
 * ```typescript
 * // In HTTP interceptor
 * catchError((error: HttpErrorResponse) => {
 *   const notification = createErrorNotificationFromHttpError({
 *     status: error.status,
 *     message: error.message,
 *     url: error.url,
 *     code: error.error?.code
 *   });
 *   this.errorService.show(notification);
 *   return throwError(() => error);
 * })
 * ```
 */
export function createErrorNotificationFromHttpError(error: {
  status?: number;
  message?: string;
  url?: string;
  code?: string;
  timestamp?: string;
}): ErrorNotification {
  const status = error.status || 0;
  const code = error.code || 'UNKNOWN_ERROR';
  const category = getErrorCategoryFromStatus(status);
  const severity = ERROR_CATEGORY_SEVERITY_MAP[category];

  return {
    category,
    severity,
    summary: getSummaryForCategory(category),
    detail: error.message || 'An unexpected error occurred',
    code,
    timestamp: error.timestamp || new Date().toISOString(),
    url: error.url,
    status,
    originalError: error
  };
}

/**
 * Create error notification from generic Error
 *
 * Converts a JavaScript Error to an ErrorNotification.
 * Typically called from global error handler.
 *
 * @param error - JavaScript Error object
 * @returns ErrorNotification object ready for display
 *
 * @example
 * ```typescript
 * // In global error handler
 * handleError(error: Error): void {
 *   const notification = createErrorNotificationFromError(error);
 *   this.errorService.show(notification);
 * }
 * ```
 */
export function createErrorNotificationFromError(error: Error): ErrorNotification {
  const code = (error as any).code;
  const category = code
    ? getErrorCategoryFromCode(code)
    : ErrorCategory.CLIENT;
  const severity = ERROR_CATEGORY_SEVERITY_MAP[category];

  return {
    category,
    severity,
    summary: getSummaryForCategory(category),
    detail: error.message || 'An unexpected error occurred',
    code,
    timestamp: new Date().toISOString(),
    originalError: error
  };
}

/**
 * Create a custom error notification
 *
 * For application-specific errors that don't come from HTTP or JavaScript errors.
 *
 * @param summary - Brief error summary
 * @param detail - Detailed error message
 * @param category - Error category (default: APPLICATION)
 * @returns ErrorNotification object
 *
 * @example
 * ```typescript
 * // Business logic error
 * if (cart.items.length === 0) {
 *   const notification = createCustomErrorNotification(
 *     'Empty Cart',
 *     'Please add items to your cart before checkout.',
 *     ErrorCategory.APPLICATION
 *   );
 *   this.errorService.show(notification);
 * }
 * ```
 */
export function createCustomErrorNotification(
  summary: string,
  detail: string,
  category: ErrorCategory = ErrorCategory.APPLICATION
): ErrorNotification {
  const severity = ERROR_CATEGORY_SEVERITY_MAP[category];

  return {
    category,
    severity,
    summary,
    detail,
    timestamp: new Date().toISOString()
  };
}

/**
 * Default display options by error category
 *
 * Some error types should be more prominent than others.
 * - Authorization errors are sticky (user must acknowledge)
 * - Validation errors auto-hide quickly
 */
export const CATEGORY_DISPLAY_OPTIONS: Record<ErrorCategory, Partial<ErrorDisplayOptions>> = {
  [ErrorCategory.NETWORK]: { life: 8000 },
  [ErrorCategory.VALIDATION]: { life: 4000 },
  [ErrorCategory.AUTHORIZATION]: { sticky: true, closable: true },
  [ErrorCategory.SERVER]: { life: 6000 },
  [ErrorCategory.CLIENT]: { life: 5000 },
  [ErrorCategory.APPLICATION]: { life: 5000 },
  [ErrorCategory.UNKNOWN]: { life: 5000 }
};

/**
 * Merge display options with category defaults
 *
 * @param category - Error category
 * @param options - Custom display options
 * @returns Merged display options
 */
export function mergeDisplayOptions(
  category: ErrorCategory,
  options?: Partial<ErrorDisplayOptions>
): ErrorDisplayOptions {
  return {
    ...DEFAULT_ERROR_DISPLAY_OPTIONS,
    ...CATEGORY_DISPLAY_OPTIONS[category],
    ...options
  };
}
```