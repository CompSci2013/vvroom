### Why Not Put This in Components?

You might ask: *Why not just subscribe to URL changes in each component?*

```typescript
// Bad: Every component manages its own state
@Component({...})
export class DiscoverComponent {
  filters$ = this.urlState.watchParams().pipe(
    map(params => this.mapper.fromUrlParams(params))
  );

  results$ = this.filters$.pipe(
    switchMap(filters => this.api.get('/vehicles', { params: filters }))
  );
}
```

Problems:
1. **Duplication** — Every component repeats the same logic
2. **No state sharing** — Pop-outs can't share state with main window
3. **No caching** — Every component fetches independently
4. **Complex cleanup** — Each component manages subscriptions

`ResourceManagementService` centralizes this:
1. **One place** for URL → filters → API → state logic
2. **State sharing** via `syncStateFromExternal()`
3. **Automatic caching** via RequestCoordinator
4. **Proper cleanup** via `ngOnDestroy()`

### Pop-Out Awareness

When the service runs in a pop-out window, it behaves differently:

- **Main window**: Watches URL, fetches data, updates state
- **Pop-out window**: Does NOT fetch (receives state from main window)

This prevents duplicate API calls and ensures consistency.

### Component-Level Injection

Unlike singleton services, `ResourceManagementService` is **not** `providedIn: 'root'`. Each component that needs resource management provides its own instance:

```typescript
@Component({
  providers: [ResourceManagementService]
})
export class DiscoverComponent {
  constructor(private resources: ResourceManagementService<F, D, S>) {}
}
```

This enables different components to manage different resources independently.

---

## What

### Step 306.1: Create the Popout Token (Placeholder)

Before creating `ResourceManagementService`, we need the `IS_POPOUT_TOKEN`. This will be fully implemented in Section 315, but we need a placeholder now.

Create `src/app/framework/tokens/popout.token.ts`:

```typescript
// src/app/framework/tokens/popout.token.ts
// VERSION 1 (Section 306) - Placeholder, fully implemented in Section 315

import { InjectionToken } from '@angular/core';

/**
 * Injection token to indicate if component is in a pop-out window
 *
 * When true, ResourceManagementService disables auto-fetching
 * and waits for state to be synced from the main window.
 */
export const IS_POPOUT_TOKEN = new InjectionToken<boolean>('IS_POPOUT_TOKEN');
```

Create the tokens barrel file `src/app/framework/tokens/index.ts`:

```typescript
// src/app/framework/tokens/index.ts
// VERSION 1 (Section 306)

export * from './popout.token';
```