---

### Step 304.2: Update the Barrel File

Update `src/app/framework/services/index.ts`:

```typescript
// src/app/framework/services/index.ts
// VERSION 4 (Section 304) - Added DomainConfigRegistry

export * from './url-state.service';
export * from './api.service';
export * from './request-coordinator.service';
export * from './domain-config-registry.service';
```

---

### Step 304.3: Understand the Dependency

Note that `DomainConfigRegistry` depends on `DomainConfigValidator` (Section 305). The registry won't compile until the validator exists.

This creates a circular documentation dependency:
- Registry (304) uses Validator (305)
- We document Registry first to show the pattern

In practice, you'll create both files, then build.

---

## Verification

### 1. Check File Exists

```bash
$ ls -la src/app/framework/services/domain-config-registry.service.ts
```

### 2. TypeScript Compilation Check

After creating Section 305 (Validator), run:

```bash
$ npx tsc --noEmit src/app/framework/services/domain-config-registry.service.ts
```

Expected: No output (no compilation errors).

### 3. Build the Application

After Section 305:

```bash
$ ng build
```

Expected: Build succeeds with no errors.

### 4. Verify Registration (Optional)

Add temporary test code:

```typescript
// In app.component.ts ngOnInit
import { DomainConfigRegistry } from './framework/services';

constructor(private registry: DomainConfigRegistry) {}

ngOnInit(): void {
  // Mock config for testing (real config comes in Phase 6)
  const mockConfig = {
    domainName: 'test-automobile',
    domainLabel: 'Test Automobiles',
    apiBaseUrl: 'http://example.com/api',
    filterModel: class {},
    dataModel: class {},
    apiAdapter: { fetchData: () => {} },
    urlMapper: { toUrlParams: () => ({}), fromUrlParams: () => ({}) },
    cacheKeyBuilder: { buildKey: () => '' },
    tableConfig: { tableId: 'test', dataKey: 'id', columns: [{ field: 'id' }] },
    pickers: [],
    filters: [],
    queryControlFilters: [],
    charts: [],
    features: { highlights: true, popOuts: true, rowExpansion: true }
  };

  this.registry.register(mockConfig as any, false); // Skip validation for test
  console.log('Registered domains:', this.registry.getAllDomainNames());
  console.log('Active domain:', this.registry.getActiveDomainName());
}
```

Console should show:
```
Domain 'test-automobile' registered successfully
Registered domains: ['test-automobile']
Active domain: test-automobile
```