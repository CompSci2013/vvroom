---

### Step 607.4: Understanding the Provider Pattern

The `DOMAIN_PROVIDER` constant is an Angular Provider:

```typescript
export const DOMAIN_PROVIDER: Provider = {
  provide: DOMAIN_CONFIG,           // Token to inject
  useFactory: createAutomobileDomainConfig,  // Factory function
  deps: [Injector],                 // Dependencies for factory
};
```

This is equivalent to:

```typescript
@NgModule({
  providers: [
    {
      provide: DOMAIN_CONFIG,
      useFactory: createAutomobileDomainConfig,
      deps: [Injector]
    }
  ]
})
```

But exported as a constant for reuse.

**How it works:**

1. Angular sees `provide: DOMAIN_CONFIG`
2. Angular calls `createAutomobileDomainConfig(injector)`
3. The factory returns the domain config object
4. Any component/service can inject `DOMAIN_CONFIG` to get the config

```typescript
// In a component
constructor(@Inject(DOMAIN_CONFIG) private config: DomainConfig<...>) {
  console.log(config.domainName); // 'automobile'
}
```

---

### Step 607.5: Understanding Chart Data Sources Mapping

The `chartDataSources` object maps dataSourceId to data source instances:

```typescript
chartDataSources: {
  'manufacturer': new ManufacturerChartDataSource(),
  'top-models': new TopModelsChartDataSource(),
  'body-class': new BodyClassChartDataSource(),
  'year': new YearChartDataSource()
}
```

This connects to chart configs from document 606:

```typescript
// Chart config
{ id: 'manufacturer-distribution', dataSourceId: 'manufacturer', ... }

// Resolution
const dataSource = chartDataSources['manufacturer'];
const traces = dataSource.transform(statistics);
```

**Note:** Chart data sources are implemented in Phase 7 (documents 651-654). This file references them but they don't exist yet. You'll create placeholder classes or add them after Phase 7.

---

### Step 607.6: Understanding Feature Flags

Feature flags enable/disable functionality without code changes:

```typescript
features: {
  highlights: true,        // Show highlight filter options
  popOuts: true,           // Show "pop out" buttons on panels
  rowExpansion: true,      // Show expand button on table rows
  statistics: true,        // Show statistics panel
  export: true,            // Show export buttons
  columnManagement: true,  // Show column visibility menu
  statePersistence: true   // Save/restore table state
}
```

Components check these flags:

```typescript
// In StatisticsPanelComponent
<div *ngIf="domainConfig.features.statistics">
  <!-- Chart content -->
</div>

// In TableComponent
<button *ngIf="domainConfig.features.export" (click)="exportCsv()">
  Export CSV
</button>
```

This allows:
- A/B testing features
- Disabling features for certain domains
- Progressive feature rollout