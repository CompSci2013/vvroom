### Debugging Subscription Issues

#### "Observable not emitting"

Check these in order:

1. **Is it subscribed?**
```typescript
// Cold observables don't run without subscription
observable$.subscribe();  // or use | async in template
```

2. **Has the source emitted?**
```typescript
source$.pipe(
  tap(v => console.log('Source emitted:', v))
).subscribe();
```

3. **Is it filtered out?**
```typescript
source$.pipe(
  tap(v => console.log('Before filter:', v)),
  filter(v => v.isValid),
  tap(v => console.log('After filter:', v))
).subscribe();
```

4. **Is switchMap cancelling it?**
```typescript
// switchMap cancels previous inner observables
// Use mergeMap if you need all to complete
```

#### "Observable emitting too many times"

```typescript
// Add distinctUntilChanged to prevent duplicates
source$.pipe(
  tap(v => console.log('Before distinct:', v)),
  distinctUntilChanged(),
  tap(v => console.log('After distinct:', v))
).subscribe();
```

#### Memory Leaks

Check for missing unsubscribe:

```typescript
// Bad - leaks on component destroy
ngOnInit() {
  this.service.data$.subscribe(data => this.data = data);
}

// Good - uses takeUntil pattern
private destroy$ = new Subject<void>();

ngOnInit() {
  this.service.data$.pipe(
    takeUntil(this.destroy$)
  ).subscribe(data => this.data = data);
}

ngOnDestroy() {
  this.destroy$.next();
  this.destroy$.complete();
}
```

---

## URL-First Debugging

### Verifying URL State

1. **Check the URL directly:**
   - Look at the browser address bar
   - Compare expected vs actual query parameters

2. **Log URL changes:**
```typescript
// In UrlStateService or component
this.router.events.pipe(
  filter(event => event instanceof NavigationEnd),
  tap(event => console.log('[Router] Navigation:', event.url))
).subscribe();
```

3. **Log parsed parameters:**
```typescript
this.route.queryParams.pipe(
  tap(params => console.log('[Route] Query params:', params))
).subscribe();
```

### Common URL-First Issues

#### Filters not updating URL

Check the URL mapper:
```typescript
console.log('[UrlMapper] toParams input:', filters);
const params = this.urlMapper.toParams(filters);
console.log('[UrlMapper] toParams output:', params);
```