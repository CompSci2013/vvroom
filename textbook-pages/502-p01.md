# 502: URL Mapper Adapter

**Status:** Complete
**Depends On:** 501-domain-adapter-pattern, 403-domain-filter-statistics-models
**Blocks:** 503-api-adapter, Phase 8 (Framework Components)

---

## Learning Objectives

After completing this section, you will:
- Understand how to map domain filters to URL query parameters
- Know how to handle bidirectional type conversion (strings ↔ numbers)
- Recognize the importance of parameter naming consistency (URL ↔ API)
- Be able to implement highlight filter extraction for chart segmentation

---

## Objective

Create the `AutomobileUrlMapper` that provides bidirectional conversion between `AutoSearchFilters` objects and URL query parameters. This adapter enables URL-First state management for the automobile domain.

---

## Why

The URL-First architecture stores application state in the URL. When a user applies filters:

1. **Filter object created:** `{ manufacturer: 'Toyota', yearMin: 2020, page: 1 }`
2. **URL updated:** `?manufacturer=Toyota&yearMin=2020&page=1`
3. **URL is shareable:** Copy/paste the URL to share the exact filter state

When a user navigates to a URL with parameters:

1. **URL parsed:** `?manufacturer=Toyota&yearMin=2020`
2. **Filter object created:** `{ manufacturer: 'Toyota', yearMin: 2020 }`
3. **Data fetched:** API called with filter values

### Bidirectional Mapping

The URL mapper handles two directions:

| Direction | Method | Purpose |
|-----------|--------|---------|
| Filters → URL | `toUrlParams()` | Generate URL from filter state |
| URL → Filters | `fromUrlParams()` | Parse URL into filter state |

### Type Conversion

URL parameters are always strings. Filter objects have typed fields:

```typescript
// URL: ?yearMin=2020&page=1
// Params: { yearMin: '2020', page: '1' }

// Filter object needs:
// { yearMin: 2020, page: 1 } (numbers, not strings)
```

The mapper handles:
- **String → Number:** `'2020'` → `2020`
- **Number → String:** `2020` → `'2020'`
- **Array → String:** `['Sedan', 'SUV']` → `'Sedan,SUV'`
- **String → Array:** `'Sedan,SUV'` → `['Sedan', 'SUV']`