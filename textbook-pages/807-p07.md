---

## Verification

### 1. Build the Application

```bash
$ cd ~/projects/vvroom
$ ng build
```

Expected: Build succeeds with no errors.

### 2. Check TypeScript Compilation

```bash
$ npx tsc --noEmit
```

Expected: No type errors.

### 3. Verify LocalStorage Key

Check `src/app/framework/components/column-manager/column-manager.component.ts`:
- `STORAGE_KEY_PREFIX` is defined
- `loadColumnStates` reads from localStorage
- `saveColumnStates` writes to localStorage

### 4. Verify Drag-Drop Integration

Check the template:
- `cdkDropList` on the column list
- `cdkDrag` on each column item
- `cdkDragHandle` on the drag handle

---

## Common Problems

| Symptom | Cause | Solution |
|---------|-------|----------|
| Column order not persisting | localStorage not saving | Verify `saveColumnStates` is called in `closeDialog` |
| New columns not appearing | Merge logic not handling new columns | Check `mergeColumnStates` adds missing columns |
| Can't hide last column | Minimum columns check working | This is expected behavior; verify `minVisibleColumns` input |
| Drag preview looks wrong | Missing CDK styles | Ensure `.cdk-drag-preview` styles are defined |
| Dialog doesn't close | `dialogVisible` not updating | Verify `closeDialog` sets `dialogVisible = false` |

---

## Key Takeaways

1. **LocalStorage provides simple persistence** - No backend required for user preferences
2. **Merge handles schema evolution** - New columns appear even if user has saved preferences
3. **CDK Drag-Drop is reusable** - Same pattern as StatisticsPanel (Section 804)

---

## Acceptance Criteria

- [ ] `ColumnManagerComponent` accepts `columns` and `domainId` inputs
- [ ] Clicking the button opens a dialog
- [ ] Columns display with checkboxes and drag handles
- [ ] Checking/unchecking toggles column visibility
- [ ] Dragging reorders columns
- [ ] At least one column must remain visible
- [ ] "Show All" button shows all columns
- [ ] "Reset" button restores default order and visibility
- [ ] "Done" button closes dialog and saves settings
- [ ] Settings persist to localStorage
- [ ] Settings survive page refresh
- [ ] `columnConfigChange` emits visible columns in correct order
- [ ] Component is registered in `FrameworkModule`
- [ ] `ng build` completes with no errors